<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8'>
	<meta http-equiv='X-UA-Compatible' content='IE=edge'>
	<title>form data to s3</title>
	<meta name='viewport' content='width=device-width, initial-scale=1'>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous">
		</script>
	<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
	<h1>formulario de prueba data to s3</h1>
	<p>form de prueba</p>
	<br>
	<a href="home_principal"> Volver</a>
	<form>
		<div>
			<p>Selecciona modelo .glb :</p>
			<input type="file" id="s3-file_glb" class="upfile" onchange="saveFile_glb(this)" accept=".glb" />
		</div>
		<div>
			<br>
			<p>Selecciona modelo .usdz :</p>
			<input type="file" id="s3-file_usdz" class="upfile" onchange="saveFile_usdz(this)" accept=".usdz" />

		</div>
		
	</form>
	<div>
		<button onclick="upload()">Enviar</button>
	</div>
</body>
<script>
	var upfile = 0;
	var upfile_1 = 0;
	function saveFile_glb(event) {
		upfile = 1;
		console.log("file " + upfile);
		const xhr = new XMLHttpRequest();
		let formData = new FormData();
		const file = event.files[0];
		formData.append('s3-file_glb', file);

		xhr.onreadystatechange = (state) => {
			console.log(xhr.status);
		}

		xhr.timeout = 5000;
		xhr.open('POST', 'upload-to-s3-glb');
		xhr.send(formData);

	}

	function saveFile_usdz(event) {
		upfile_1 = 1;
		console.log("file 1 " + upfile_1);

		const xhr = new XMLHttpRequest();
		let formData = new FormData();
		const file = event.files[0];
		formData.append('s3-file_usdz', file);

		xhr.onreadystatechange = (state) => {
			console.log(xhr.status);
		}

		xhr.timeout = 5000;
		xhr.open('POST', 'upload-to-s3-usdz');
		xhr.send(formData);

	}

</script>
<script>
	function upload() {


		if (upfile == 0 || upfile_1 == 0) {
			Swal.fire({
				icon: 'warning',
				title: 'Â¡Porfavor sube ambos archivos!',
				showConfirmButton: false,
				timer: 1500
			})
		} else if (upfile == 1 && upfile_1 == 1) {
			Swal.fire({
				icon: 'success',
				title: 'Tus archivos han subido!',
				showConfirmButton: false,
				timer: 1500
			})
			setTimeout(() => {
				location.href = "home_principal";
			}, 1600);
			
		}

	}


</script>

</html>